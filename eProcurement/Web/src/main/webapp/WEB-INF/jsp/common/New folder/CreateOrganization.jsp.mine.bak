<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
		<c:choose>
			<c:when test="${optType eq 'edit'}">
				<%@include file="./../includes/header.jsp"%>												
			</c:when>
			<c:otherwise>
				<%@include file="./../includes/headerWithoutLogin.jsp"%>	
			</c:otherwise>
		</c:choose>
        <%@taglib prefix="spring" uri="http://www.springframework.org/tags"%>
        <script src="${pageContext.servletContext.contextPath}/resources/js/commonValidate.js" type="text/javascript"></script>
        <script src="${pageContext.servletContext.contextPath}/resources/js/jquery-ui.custom.js" type="text/javascript"></script>
		<script src="${pageContext.servletContext.contextPath}/resources/js/jquery.cookie.js" type="text/javascript"></script>
		<script src="${pageContext.servletContext.contextPath}/resources/js/blockUI.js" type="text/javascript"></script>
        <script src="${pageContext.request.contextPath}/resources/js/commonListing.js"></script>
        <link rel="stylesheet" href="${pageContext.servletContext.contextPath}/resources/css/jquery-ui.min.css">        
        <spring:message code="lbl_create_org" var="createdepartment"/>
        <title>${createdepartment}</title>
        <script type="text/javascript">
        var VALIDATE_MSG_REQUIRED = 'Please enter';
        var VALIDATE_MSG_SELECT = 'Please select';
        var VALIDATE_MSG_ALLOW_MAX='Allows Max. ';
        var VALIDATE_MSG_TENDERBRIEF='characters';
        var isDepartmentExists=false;
		var optType = '${optType}';
        
        if(optType=='edit'){
	       	var countryId = '${bidderDtls[9]}';
        	var stateId = '${bidderDtls[8]}';
        }
        var obj = (${countryJson});
        
        $(document).ready(function() {
        	$('#selCountry').html('');
	     	$.each(obj, function (key, value) {
	    	$('#selCountry').append($('<option>',
	    		 {
	    		    value: value.value,
	    		    text : value.label
	    		}));
	    	 });
			
	     	
	     	if(optType=='Edit'){
	     	$('select[id="selCountry"] option:selected').attr("selected",null);
   	     	$('select[id="selCountry"] option[value="'+countryId+'"]').attr("selected","selected");
	     	getState();
	     	$('select[id="selState"] option:selected').attr("selected",null);
   	     	$('select[id="selState"] option[value="'+stateId+'"]').attr("selected","selected");
	     	}
	     	
    	});
        
            function validate(){
            	$('#txtPhoneNo').val($('#txtPhoneNo1').val()+$('#txtPhoneNo2').val()+$('#txtPhoneNo').val());
            	$('#orgstatus').val($('input[name=rdorgstatus]:checked').val());
            	var vbool = valOnSubmit();
            	return disableBtn(vbool);
            }
            
            function getState(){
                var countryId = $("#selCountry").val();
                if(countryId != ""){
                	$.ajax({
            		contentType : "application/json",
            		url : "${pageContext.servletContext.contextPath}/common/user/getstatebycountry/"+countryId,
            		dataType: "json",
            		async:false,
            		success : function(data) {
            			$("#selState option").not(":first").remove();
            			for(var i = 0; i <data.length;i++){
            				$("#selState").append("<option value='"+data[i][0]+"'>"+data[i][1]+"</option>")
            			}
            		},
            		error : function(e) {
            			console.log("ERROR: ", e);
            		},
            	});
                }
                }
            
            
  			$(document).ready(function(){
                $('a.myModel').click(function(){   //bind handlers
         		   var url = $(this).attr('href');
         		   showDialog(url);
         		   return false;
         		});

         		$("#targetDiv").dialog({  //create dialog, but keep it closed
         		   autoOpen: false,
         		   height: 300,
         		   width: 700,
         		   modal: true
         		});

         		function showDialog(url){  //load content and open dialog
         		    $("#targetDiv").load(url);
         		    $("#targetDiv").dialog("open");         
         		}
                });
  			
           </script>
           <style>
           .displaynone{
           	display: none;
           }
           </style>
           <script src='https://www.google.com/recaptcha/api.js'></script>	
    </head>
    <body>
<div class="content-wrapper" style="height: auto; ">
<section class="content-header">

</section>

<section class="content">
<div class="row">
				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
					<div class="box">
						<c:if test="${not empty successMsg}">
                                        			<div class="alert alert-success"><spring:message code="${successMsg}"/></div>
                                    		</c:if>
                                    		<c:if test="${not empty errorMsg}">
                                        			<div class="alert alert-danger"><spring:message code="${errorMsg}"/></div>
                                    		</c:if>
						<div class="box-header with-border">
							<c:choose>
	               					<c:when test="${optType eq 'edit'}">
	               					<spring:message code="lbl_edit_org" var="editdepartment"/>
	               						<h3 class="box-title">Organization</h3>											
	               					</c:when>
	               					<c:otherwise>
	               					<spring:message code="lbl_create_org" var="lbl_create_org"/>
	               						<h3 class="box-title">${lbl_create_org}</h3>
								</c:otherwise>
								</c:choose>
						</div>
						<div class="box-body">
							<div class="row">
								<c:choose>
	               					<c:when test="${optType eq 'edit'}">
		               					<spring:url value="/common/user/editOrganization" var="submitDept"/>
	               					</c:when>
	               					<c:otherwise>
										<spring:url value="/common/user/addOrganization" var="submitDept"/>               						
									</c:otherwise>
								</c:choose>
								<div class="col-lg-12 col-md-12 col-xs-12">
									<form:form action="${submitDept}" onsubmit="return validate();" name="frmdepartment" method="post" modelAttribute="tblDepartment" >
									<input type="hidden" name="orgstatus" id="orgstatus" value="0"/>
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">Organization Name<span style="color: red">*</span>:</div>
										</div>
										<div class="col-lg-5">
											<c:choose>
				               					<c:when test="${optType eq 'edit'}">
				               						<label>${tblDepartment.deptName}</label>
					               					<form:hidden  id="deptId" path="deptId" ></form:hidden>
					               					<form:hidden  id="deptName" path="deptName" value="${tblDepartment.deptName}" ></form:hidden>
													<input type="hidden"  id="isDeptExists" value="" />
													<div id="deptError" style="color: red"></div>
				               					</c:when>
				               					<c:otherwise>
													<form:input class="form-control" id="deptName" path="deptName" validarr="required@@tenderbrief:100" tovalid="true" onblur="validateTxtComp(this)" title="Organization Name" ></form:input>
													<form:hidden  id="deptId" path="deptId" ></form:hidden>
													<input type="hidden"  id="isDeptExists" value="" />
													<div id="deptError" style="color: red"></div>               						
												</c:otherwise>
											</c:choose>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">Address :</div>
										</div>
										<div class="col-lg-5">
											<c:choose>
				               					<c:when test="${optType eq 'edit'}">
				               						<label>${tblDepartment.address}</label>
				               					</c:when>
				               					<c:otherwise>
													<form:textarea class="form-control" id="address" path="address" validarr="length:0,200" tovalid="true" onblur="validateTxtComp(this)" validationmsg="Allows Max. 200 alphabets, numbers and special characters" title="address"></form:textarea>               						
												</c:otherwise>
											</c:choose>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">Country<span style="color: red">*</span></div>
										</div>
										<div class="col-lg-5">
												<c:choose>
				               					<c:when test="${optType eq 'edit'}">
				               						<label>${country}</label>
				               					</c:when>
				               					<c:otherwise>
				               						<select class="form-control" id="selCountry" name="selCountry" isrequired="true" onchange="if(validateCombo(this)){getState()}" title="Country">
													</select>
				               					</c:otherwise>
				               					</c:choose>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">State<span style="color: red">*</span></div>
										</div>
										<div class="col-lg-5">
												<c:choose>
				               					<c:when test="${optType eq 'edit'}">
				               						<label>${state}</label>
				               					</c:when>
				               					<c:otherwise>
				               						<select class="form-control" id="selState" name="selState" isrequired="true" onchange="validateCombo(this)" title="State">
				               							<option value="">Select</option>
													</select>
				               					</c:otherwise>
				               					</c:choose>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">City.</div>
											
										</div>
										<div class="col-lg-5">
												<c:choose>
				               					<c:when test="${optType eq 'edit'}">
													<label>${tblDepartment.city}</label>
				               					</c:when>
				               					<c:otherwise>
													<form:input id="txtCity" path="city" class="form-control" name="txtCity" validarr="length:0,20" tovalid="false" onblur="validateTxtComp(this)" title="City"  type="text"></form:input>
				               					</c:otherwise>
				               					</c:choose>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">Phone no.<span style="color: red">*</span></div>
											
										</div>
										<div class="col-lg-5">
												<c:choose>
				               					<c:when test="${optType eq 'edit'}">
													<label>${tblDepartment.phoneno}</label>
				               					</c:when>
				               					<c:otherwise>
				               						<div>
				               						<input id="txtPhoneNo1"   class="form-control" style="width: 60px;float: left" name="txtPhoneNo1" validarr="required@@length:0,3@@phoneno" tovalid="true" onblur="validateTxtComp(this)" title="Phone no." validationmsg="Allows max. 3 numbers and special characters (-,+)" type="text"><label style="float: left">-</label>
													<input id="txtPhoneNo2"  class="form-control" style="width: 60px;float: left" name="txtPhoneNo2" validarr="required@@length:0,3@@phoneno" tovalid="true" onblur="validateTxtComp(this)" title="Phone no." validationmsg="Allows max. 3 numbers and special characters (-,+)" type="text"><label style="float: left">-</label>
													<input id="txtPhoneNo" class="form-control" style="width: 200px;float: left" name="txtPhoneNo" validarr="required@@length:0,20@@phoneno" tovalid="true" onblur="validateTxtComp(this)" title="Phone no." validationmsg="Allows max. 20 numbers and special characters (-,+)" type="text">
													</div>
				               					</c:otherwise>
				               					</c:choose>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">Mobile no.</div>
										</div>
										<div class="col-lg-5">
												<c:choose>
				               					<c:when test="${optType eq 'edit'}">
				               						<label>${tblDepartment.mobileNo}</label>
				               					</c:when>
				               					<c:otherwise>
													<input id="txtMobileNo" class="form-control" name="txtMobileNo" validarr="length:0,15@@phoneno" tovalid="true" onblur="validateTxtComp(this)" title="Mobile no." validationmsg="Allows max 15 number (0 to 9)" type="text">
				               					</c:otherwise>
				               					</c:choose>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">Web site</div>
											
										</div>
										<div class="col-lg-5">
												<c:choose>
				               					<c:when test="${optType eq 'edit'}">
													<label>${tblDepartment.website}</label>
				               					</c:when>
				               					<c:otherwise>
													<input id="txtWebsite" class="form-control" name="txtWebsite" validarr="website" tovalid="true" onblur="validateTxtComp(this)" title="Website"  type="text">
				               					</c:otherwise>
				               					</c:choose>
										</div>
									</div>
									<c:if test="${optType ne 'edit'}">
									<div class="row">
										<div class="col-lg-2">
											
										</div>
										<div class="col-lg-5">
											<div class="g-recaptcha" data-sitekey="6Ld1eBIUAAAAAAH43IoWk1nmD-MMvcWaDYEQIO9o"></div>
										</div>
									</div>
									</c:if>
									<c:if test="${optType eq 'edit'}">
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">status</div>
										</div>
										<div class="col-lg-5">
												<input type="radio" name="rdorgstatus" id="rdorgstatus" value="1" /> Approve 
												<input type="radio" name="rdorgstatus" id="rdorgstatus" value="0"/> Pending
												
										</div>
									</div>
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">Remarks</div>
										</div>
										<div class="col-lg-5">
													<textarea id="txtaremarks" class="form-control" name="txtaremarks" validarr="required@@length:0,500" tovalid="true" onblur="validateTxtComp(this)" title="remarks" validationmsg="Allows max. 500 characters and special character (',- , .,space)" ></textarea>
										</div>
									</div>	
									<div class="row">
										<div class="col-lg-2">
											<div class="form_filed">Uploaded documents</div>
										</div>
										<div class="col-lg-5">
											<a href="${pageContext.servletContext.contextPath}/etender/buyer/getDocumentList/${objectId}/${childId}/${childId}/0/0" data-target="#myModal" class="myModel" data-toggle="modal">View uploaded documents</a>
										</div>
										<div id="targetDiv"></div>
 				
									</div>
									</c:if>
									<div class="row displaynone">
										<div class="col-lg-2">
											<div class="form_filed">Mail hostname :</div>
										</div>
										<div class="col-lg-5">
											<form:input class="form-control" id="mailHostName" path="mailHostName" tovalid="true" onblur="validateTxtComp(this)" title="department name" ></form:input>
										</div>
									</div>
									<div class="row displaynone">
										<div class="col-lg-2">
											<div class="form_filed">Mail port number</div>
										</div>
										<div class="col-lg-5">
											<form:input class="form-control" id="mailPort" path="mailPort" tovalid="true" onblur="validateTxtComp(this)" title="department name" ></form:input>
										</div>
									</div>
									<div class="row displaynone">
										<div class="col-lg-2">
											<div class="form_filed">From email address</div>
										</div>
										<div class="col-lg-5">
											<form:input class="form-control" id="fromMailId" path="fromMailId" tovalid="true" onblur="validateTxtComp(this)" title="department name" ></form:input>
										</div>
									</div>
									<div class="row displaynone">
										<div class="col-lg-2">
											<div class="form_filed">Mail username</div>
										</div>
										<div class="col-lg-5">
											<form:input class="form-control" id="mailUsername" path="mailUsername"  tovalid="true" onblur="validateTxtComp(this)" title="department name" ></form:input>
										</div>
									</div>
									<div class="row displaynone">
										<div class="col-lg-2 displaynone">
											<div class="form_filed">Mail password</div>
										</div>
										<div class="col-lg-5 col-md-offset-2">
											<form:input class="form-control" id="mailPassword" path="mailPassword"  tovalid="true" onblur="validateTxtComp(this)" title="department name" ></form:input>
										</div>
									</div>
									<div class="row">
										<div class="col-lg-2">
											<br>
										</div>
										<div class="col-lg-5">
											<button type="submit" id="addDept"  class="btn btn-submit">Submit</button>
											<input type="hidden" name="childId" id="childId" value="${childId}">
										</div>
									</div>
									</form:form>
								</div>
							</div>
						</div>
					<div class="box-body">
							<div class="row">
								<div class="col-lg-12 col-md-12 col-xs-12">
								<input type="hidden" name="defaultOrder" id="defaultOrder" value="3:desc">
												<div id="listingDiv">
												</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				</div>
</section>


</div>  
<script type="text/javascript">
loadListPage('listingDiv',21);
function callActionItem(cthis){
	var actionname = $(cthis).attr("actionname");
	console.log(actionname);
	if(actionname = "edit"){
		var deptId = $(cthis).closest("tr").find('td:nth-child(4)').html()
		window.location = "${pageContext.servletContext.contextPath}/common/user/geteditorganization/"+deptId;
	}
	
}
</script>
  <script type="text/javascript">
  
</script>
    </body>
</html>